<!DOCTYPE html>
<html lang="et">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loovt√∂√∂</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            color: #fff;
            overflow: hidden;
        }

        .game-container {
            max-width: 900px;
            width: 95%;
            background: rgba(15, 15, 30, 0.9);
            border: 3px solid #0f4c75;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 0 50px rgba(59, 130, 246, 0.3);
        }

        .game-header {
            text-align: center;
            margin-bottom: 20px;
            padding: 15px;
            background: linear-gradient(90deg, #3b82f6, #8b5cf6);
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.4);
        }

        h1 {
            font-size: 2.2em;
            text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.8);
            letter-spacing: 2px;
            margin-bottom: 5px;
        }

        .level-info {
            font-size: 1.2em;
            color: #ffd700;
            text-shadow: 1px 1px 3px #000;
        }

        canvas {
            display: block;
            background: linear-gradient(180deg, #87ceeb 0%, #e0f6ff 50%, #90ee90 100%);
            border: 4px solid #0f4c75;
            border-radius: 8px;
            margin: 20px auto;
            box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.2);
        }

        .controls {
            text-align: center;
            margin-top: 15px;
            padding: 15px;
            background: rgba(59, 130, 246, 0.1);
            border-radius: 8px;
            border: 2px solid #3b82f6;
        }

        .controls p {
            font-size: 1.1em;
            margin: 8px 0;
            color: #94c5f8;
        }

        .controls strong {
            color: #ffd700;
            font-size: 1.15em;
        }

        .btn {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 1.1em;
            font-weight: bold;
            border-radius: 8px;
            cursor: pointer;
            margin: 10px 5px;
            transition: all 0.3s;
            box-shadow: 0 4px 10px rgba(59, 130, 246, 0.4);
            font-family: 'Courier New', monospace;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.6);
            background: linear-gradient(135deg, #2563eb, #1d4ed8);
        }

        .btn:active {
            transform: translateY(0);
        }

        .message {
            text-align: center;
            font-size: 1.3em;
            padding: 15px;
            margin: 15px 0;
            border-radius: 8px;
            font-weight: bold;
            display: none;
            animation: fadeIn 0.5s;
        }

        .message.success {
            background: rgba(34, 197, 94, 0.2);
            border: 2px solid #22c55e;
            color: #86efac;
        }

        .message.game-over {
            background: rgba(239, 68, 68, 0.2);
            border: 2px solid #ef4444;
            color: #fca5a5;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        .stats {
            display: flex;
            justify-content: space-around;
            margin: 15px 0;
            padding: 12px;
            background: rgba(15, 23, 42, 0.5);
            border-radius: 8px;
            border: 2px solid #1e40af;
        }

        .stat {
            text-align: center;
        }

        .stat-value {
            font-size: 1.8em;
            color: #ffd700;
            font-weight: bold;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }

        .stat-label {
            font-size: 0.9em;
            color: #94c5f8;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="game-header">
            <h1>üéÆ LOOVT√ñ√ñ</h1>
            <div class="level-info">Tase <span id="currentLevel">1</span> / 6</div>
        </div>

        <div class="stats">
            <div class="stat">
                <div class="stat-value" id="deaths">0</div>
                <div class="stat-label">Surma</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="time">0</div>
                <div class="stat-label">Aeg (s)</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="attempts">1</div>
                <div class="stat-label">Katse</div>
            </div>
        </div>

        <canvas id="gameCanvas" width="800" height="500"></canvas>

        <div id="message" class="message"></div>

        <div class="controls">
            <p><strong>Nooled ‚Üê‚Üí</strong> - Liiguta | <strong>T√ºhik / ‚Üë</strong> - H√ºppa</p>
            <p><strong>R</strong> - Taask√§ivita tase</p>
            <button class="btn" onclick="game.reset()">üîÑ Taask√§ivita</button>
            <button class="btn" onclick="game.skipLevel()" id="skipBtn">‚è≠Ô∏è J√§rgmine tase (test)</button>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        const game = {
            currentLevel: 1,
            deaths: 0,
            startTime: Date.now(),
            attempts: 1,
            
            levels: [
                // Level 1: Lihtne algus
                {
                    name: "Algus",
                    player: { x: 50, y: 350 },
                    goal: { x: 720, y: 100, width: 50, height: 50 },
                    platforms: [
                        { x: 0, y: 450, width: 250, height: 50 },
                        { x: 280, y: 380, width: 150, height: 20 },
                        { x: 460, y: 310, width: 150, height: 20 },
                        { x: 640, y: 240, width: 160, height: 20 },
                        { x: 680, y: 170, width: 120, height: 20 }
                    ],
                    obstacles: []
                },
                
                // Level 2: Liikuvad takistused
                {
                    name: "Liikuvad platvormid",
                    player: { x: 50, y: 350 },
                    goal: { x: 720, y: 100, width: 50, height: 50 },
                    platforms: [
                        { x: 0, y: 450, width: 200, height: 50 },
                        { x: 230, y: 380, width: 150, height: 20 },
                        { x: 410, y: 310, width: 150, height: 20 },
                        { x: 590, y: 240, width: 150, height: 20 },
                        { x: 680, y: 170, width: 120, height: 20 }
                    ],
                    obstacles: [
                        { type: 'danger', x: 230, y: 310, width: 40, height: 40, moving: true, speed: 2, range: 60, startY: 310 },
                        { type: 'danger', x: 590, y: 170, width: 40, height: 40, moving: true, speed: 2, range: 60, startY: 170 }
                    ]
                },
                
                // Level 3: Ogad
                {
                    name: "Ogad",
                    player: { x: 50, y: 350 },
                    goal: { x: 720, y: 80, width: 50, height: 50 },
                    platforms: [
                        { x: 0, y: 450, width: 200, height: 50 },
                        { x: 230, y: 380, width: 170, height: 20 },
                        { x: 430, y: 310, width: 170, height: 20 },
                        { x: 630, y: 240, width: 170, height: 20 },
                        { x: 680, y: 150, width: 120, height: 20 }
                    ],
                    obstacles: [
                        { type: 'spike', x: 270, y: 350, width: 30, height: 30 },
                        { type: 'spike', x: 310, y: 350, width: 30, height: 30 },
                        { type: 'spike', x: 470, y: 280, width: 30, height: 30 },
                        { type: 'spike', x: 510, y: 280, width: 30, height: 30 },
                        { type: 'spike', x: 670, y: 210, width: 30, height: 30 }
                    ]
                },
                
                // Level 4: Kitsas rada
                {
                    name: "Kitsas rada",
                    player: { x: 50, y: 380 },
                    goal: { x: 720, y: 380, width: 50, height: 50 },
                    platforms: [
                        { x: 0, y: 450, width: 150, height: 50 },
                        { x: 180, y: 450, width: 100, height: 20 },
                        { x: 310, y: 450, width: 100, height: 20 },
                        { x: 440, y: 450, width: 100, height: 20 },
                        { x: 570, y: 450, width: 100, height: 20 },
                        { x: 700, y: 450, width: 100, height: 20 }
                    ],
                    obstacles: [
                        { type: 'spike', x: 185, y: 420, width: 25, height: 30 },
                        { type: 'spike', x: 315, y: 420, width: 25, height: 30 },
                        { type: 'spike', x: 445, y: 420, width: 25, height: 30 },
                        { type: 'spike', x: 575, y: 420, width: 25, height: 30 }
                    ]
                },
                
                // Level 5: Lab√ºrint
                {
                    name: "Lab√ºrint",
                    player: { x: 50, y: 350 },
                    goal: { x: 720, y: 80, width: 50, height: 50 },
                    platforms: [
                        { x: 0, y: 450, width: 200, height: 50 },
                        { x: 230, y: 380, width: 170, height: 20 },
                        { x: 80, y: 310, width: 170, height: 20 },
                        { x: 280, y: 240, width: 170, height: 20 },
                        { x: 480, y: 310, width: 170, height: 20 },
                        { x: 680, y: 150, width: 120, height: 20 }
                    ],
                    obstacles: [
                        { type: 'wall', x: 250, y: 240, width: 20, height: 140 },
                        { type: 'wall', x: 460, y: 150, width: 20, height: 160 },
                        { type: 'danger', x: 480, y: 240, width: 40, height: 40, moving: true, speed: 2, range: 60, startY: 240 }
                    ]
                },
                
                // Level 6: Finaal - k√µige raskem
                {
                    name: "Finaal",
                    player: { x: 50, y: 350 },
                    goal: { x: 720, y: 50, width: 50, height: 50 },
                    platforms: [
                        { x: 0, y: 450, width: 150, height: 50 },
                        { x: 180, y: 390, width: 120, height: 20 },
                        { x: 330, y: 330, width: 120, height: 20 },
                        { x: 180, y: 270, width: 120, height: 20 },
                        { x: 330, y: 210, width: 120, height: 20 },
                        { x: 480, y: 270, width: 120, height: 20 },
                        { x: 630, y: 210, width: 120, height: 20 },
                        { x: 680, y: 120, width: 120, height: 20 }
                    ],
                    obstacles: [
                        { type: 'spike', x: 185, y: 360, width: 25, height: 30 },
                        { type: 'spike', x: 335, y: 300, width: 25, height: 30 },
                        { type: 'spike', x: 185, y: 240, width: 25, height: 30 },
                        { type: 'spike', x: 335, y: 180, width: 25, height: 30 },
                        { type: 'danger', x: 480, y: 200, width: 40, height: 40, moving: true, speed: 2, range: 60, startY: 200 },
                        { type: 'danger', x: 630, y: 140, width: 40, height: 40, moving: true, speed: 2.5, range: 60, startY: 140 }
                    ]
                }
            ],

            player: {
                x: 50,
                y: 350,
                width: 30,
                height: 30,
                velocityX: 0,
                velocityY: 0,
                speed: 5,
                jumpPower: 12,
                gravity: 0.5,
                isOnGround: false
            },

            keys: {},

            init() {
                this.loadLevel(1);
                this.setupControls();
                this.gameLoop();
            },

            loadLevel(levelNum) {
                this.currentLevel = levelNum;
                const level = this.levels[levelNum - 1];
                
                this.player.x = level.player.x;
                this.player.y = level.player.y;
                this.player.velocityX = 0;
                this.player.velocityY = 0;
                this.player.isOnGround = false;
                
                document.getElementById('currentLevel').textContent = levelNum;
                this.hideMessage();
                
                // Update skip button visibility
                document.getElementById('skipBtn').style.display = 
                    this.currentLevel < this.levels.length ? 'inline-block' : 'none';
            },

            setupControls() {
                document.addEventListener('keydown', (e) => {
                    this.keys[e.key] = true;
                    
                    if (e.key === ' ' || e.key === 'ArrowUp') {
                        e.preventDefault();
                        if (this.player.isOnGround) {
                            this.player.velocityY = -this.player.jumpPower;
                            this.player.isOnGround = false;
                        }
                    }
                    
                    if (e.key === 'r' || e.key === 'R') {
                        this.reset();
                    }
                });

                document.addEventListener('keyup', (e) => {
                    this.keys[e.key] = false;
                });
            },

            gameLoop() {
                this.update();
                this.draw();
                requestAnimationFrame(() => this.gameLoop());
            },

            update() {
                const level = this.levels[this.currentLevel - 1];

                // Horizontal movement
                if (this.keys['ArrowLeft']) {
                    this.player.velocityX = -this.player.speed;
                } else if (this.keys['ArrowRight']) {
                    this.player.velocityX = this.player.speed;
                } else {
                    this.player.velocityX = 0;
                }

                // Apply velocity
                this.player.x += this.player.velocityX;
                this.player.y += this.player.velocityY;

                // Apply gravity
                this.player.velocityY += this.player.gravity;
                this.player.isOnGround = false;

                // Platform collision
                level.platforms.forEach(platform => {
                    if (this.checkCollision(this.player, platform)) {
                        // Top collision (landing)
                        if (this.player.velocityY > 0 && 
                            this.player.y + this.player.height - this.player.velocityY <= platform.y + 5) {
                            this.player.y = platform.y - this.player.height;
                            this.player.isOnGround = true;
                            this.player.velocityY = 0;
                        }
                        // Bottom collision
                        else if (this.player.velocityY < 0 && 
                                 this.player.y - this.player.velocityY >= platform.y + platform.height - 5) {
                            this.player.y = platform.y + platform.height;
                            this.player.velocityY = 0;
                        }
                        // Side collision
                        else {
                            if (this.player.x < platform.x) {
                                this.player.x = platform.x - this.player.width;
                            } else {
                                this.player.x = platform.x + platform.width;
                            }
                        }
                    }
                });

                // Obstacle collision (death)
                level.obstacles.forEach(obstacle => {
                    if (obstacle.type === 'danger' || obstacle.type === 'spike') {
                        if (this.checkCollision(this.player, obstacle)) {
                            this.die();
                        }
                    } else if (obstacle.type === 'wall') {
                        if (this.checkCollision(this.player, obstacle)) {
                            // Wall collision
                            if (this.player.x < obstacle.x) {
                                this.player.x = obstacle.x - this.player.width;
                            } else {
                                this.player.x = obstacle.x + obstacle.width;
                            }
                        }
                    }
                });

                // Update moving obstacles
                level.obstacles.forEach(obstacle => {
                    if (obstacle.moving) {
                        obstacle.y += obstacle.speed;
                        if (obstacle.y > obstacle.startY + obstacle.range || obstacle.y < obstacle.startY) {
                            obstacle.speed *= -1;
                        }
                    }
                });

                // Boundary collision
                if (this.player.x < 0) this.player.x = 0;
                if (this.player.x + this.player.width > canvas.width) {
                    this.player.x = canvas.width - this.player.width;
                }

                // Fall off screen
                if (this.player.y > canvas.height) {
                    this.die();
                }

                // Goal collision
                if (this.checkCollision(this.player, level.goal)) {
                    this.levelComplete();
                }
            },

            checkCollision(rect1, rect2) {
                return rect1.x < rect2.x + rect2.width &&
                       rect1.x + rect1.width > rect2.x &&
                       rect1.y < rect2.y + rect2.height &&
                       rect1.y + rect1.height > rect2.y;
            },

            draw() {
                // Clear canvas
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                const level = this.levels[this.currentLevel - 1];

                // Draw platforms
                level.platforms.forEach(platform => {
                    ctx.fillStyle = '#8b4513';
                    ctx.fillRect(platform.x, platform.y, platform.width, platform.height);
                    ctx.strokeStyle = '#654321';
                    ctx.lineWidth = 3;
                    ctx.strokeRect(platform.x, platform.y, platform.width, platform.height);
                });

                // Draw obstacles
                level.obstacles.forEach(obstacle => {
                    if (obstacle.type === 'wall') {
                        ctx.fillStyle = '#555';
                        ctx.fillRect(obstacle.x, obstacle.y, obstacle.width, obstacle.height);
                        ctx.strokeStyle = '#333';
                        ctx.lineWidth = 2;
                        ctx.strokeRect(obstacle.x, obstacle.y, obstacle.width, obstacle.height);
                    } else if (obstacle.type === 'spike') {
                        ctx.fillStyle = '#ff0000';
                        ctx.beginPath();
                        ctx.moveTo(obstacle.x, obstacle.y + obstacle.height);
                        ctx.lineTo(obstacle.x + obstacle.width / 2, obstacle.y);
                        ctx.lineTo(obstacle.x + obstacle.width, obstacle.y + obstacle.height);
                        ctx.closePath();
                        ctx.fill();
                        ctx.strokeStyle = '#cc0000';
                        ctx.lineWidth = 2;
                        ctx.stroke();
                    } else if (obstacle.type === 'danger') {
                        ctx.fillStyle = '#ff4444';
                        ctx.fillRect(obstacle.x, obstacle.y, obstacle.width, obstacle.height);
                        ctx.fillStyle = '#fff';
                        ctx.font = 'bold 28px Arial';
                        ctx.textAlign = 'center';
                        ctx.fillText('!', obstacle.x + obstacle.width / 2, obstacle.y + obstacle.height / 2 + 10);
                    }
                });

                // Draw goal
                ctx.fillStyle = '#ffd700';
                ctx.fillRect(level.goal.x, level.goal.y, level.goal.width, level.goal.height);
                ctx.strokeStyle = '#ff8c00';
                ctx.lineWidth = 3;
                ctx.strokeRect(level.goal.x, level.goal.y, level.goal.width, level.goal.height);
                
                // Star in goal
                ctx.fillStyle = '#fff';
                ctx.font = 'bold 35px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('‚òÖ', level.goal.x + level.goal.width / 2, level.goal.y + level.goal.height / 2 + 12);

                // Draw player
                ctx.fillStyle = '#3b82f6';
                ctx.fillRect(this.player.x, this.player.y, this.player.width, this.player.height);
                ctx.strokeStyle = '#1e40af';
                ctx.lineWidth = 2;
                ctx.strokeRect(this.player.x, this.player.y, this.player.width, this.player.height);
                
                // Player eyes
                ctx.fillStyle = '#fff';
                ctx.fillRect(this.player.x + 7, this.player.y + 8, 6, 6);
                ctx.fillRect(this.player.x + 17, this.player.y + 8, 6, 6);
                ctx.fillStyle = '#000';
                ctx.fillRect(this.player.x + 9, this.player.y + 10, 3, 3);
                ctx.fillRect(this.player.x + 19, this.player.y + 10, 3, 3);
            },

            die() {
                this.deaths++;
                this.attempts++;
                this.updateStats();
                this.loadLevel(this.currentLevel);
                this.showMessage('üíÄ Suri! Proovi uuesti!', 'game-over');
                setTimeout(() => this.hideMessage(), 2000);
            },

            levelComplete() {
                if (this.currentLevel < this.levels.length) {
                    this.showMessage('üéâ Tase l√§bitud! J√§rgmine tase...', 'success');
                    setTimeout(() => {
                        this.currentLevel++;
                        this.loadLevel(this.currentLevel);
                    }, 2000);
                } else {
                    const timeElapsed = Math.floor((Date.now() - this.startTime) / 1000);
                    this.showMessage(`üèÜ Palju √µnne! L√§bisid k√µik 6 taset!\n‚è±Ô∏è Aeg: ${timeElapsed}s | üíÄ Surmasid: ${this.deaths}`, 'success');
                }
            },

            skipLevel() {
                if (this.currentLevel < this.levels.length) {
                    this.currentLevel++;
                    this.loadLevel(this.currentLevel);
                    this.showMessage('‚è≠Ô∏è H√ºpati j√§rgmisele tasemele', 'success');
                    setTimeout(() => this.hideMessage(), 1500);
                }
            },

            reset() {
                this.loadLevel(this.currentLevel);
                this.attempts++;
                this.updateStats();
            },

            updateStats() {
                document.getElementById('deaths').textContent = this.deaths;
                document.getElementById('attempts').textContent = this.attempts;
                const timeElapsed = Math.floor((Date.now() - this.startTime) / 1000);
                document.getElementById('time').textContent = timeElapsed;
            },

            showMessage(text, type) {
                const msg = document.getElementById('message');
                msg.textContent = text;
                msg.className = 'message ' + type;
                msg.style.display = 'block';
            },

            hideMessage() {
                document.getElementById('message').style.display = 'none';
            }
        };

        // Update time every second
        setInterval(() => game.updateStats(), 1000);

        // Start game
        game.init();
    </script>
</body>
</html>
